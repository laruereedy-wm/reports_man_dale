<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Tablix Name="table1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>0.99511in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.99511in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.99511in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.99511in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.99511in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.99511in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox38">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Sum(Fields!WEEK1QTY.Value)</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <Format>#,##0</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <ZIndex>5</ZIndex>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox39">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Sum(Fields!WEEK2QTY.Value)</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <Format>#,##0</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <ZIndex>4</ZIndex>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox40">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Sum(Fields!WEEK3QTY.Value)</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <Format>#,##0</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <ZIndex>3</ZIndex>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox41">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Sum(Fields!WEEK4QTY.Value)</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <Format>#,##0</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <ZIndex>2</ZIndex>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox42">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Sum(Fields!WEEK5QTY.Value)</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <Format>#,##0</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <ZIndex>1</ZIndex>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox43">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Sum(Fields!WEEK6QTY.Value)</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <Format>#,##0</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group Name="table1_Group1">
                <GroupExpressions>
                  <GroupExpression>=Fields!IM_PLANNER.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!IM_PLANNER.Value</Value>
                </SortExpression>
              </SortExpressions>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <NoRowsMessage>          0                     0                     0                     0                     0                     0</NoRowsMessage>
        <DataSetName>mainData</DataSetName>
        <Filters>
          <Filter>
            <FilterExpression>=IIf(Parameters!allOpenedPlanned.Value = "OPEN", Fields!STATUS.Value, Fields!ALL.Value)</FilterExpression>
            <Operator>Equal</Operator>
            <FilterValues>
              <FilterValue>=Parameters!allOpenedPlanned.Value</FilterValue>
            </FilterValues>
          </Filter>
        </Filters>
        <Height>0.25in</Height>
        <Width>5.97066in</Width>
        <Style>
          <FontFamily>Tahoma</FontFamily>
        </Style>
      </Tablix>
    </ReportItems>
    <Height>0.25in</Height>
    <Style />
  </Body>
  <Width>5.97066in</Width>
  <Page>
    <LeftMargin>1in</LeftMargin>
    <RightMargin>1in</RightMargin>
    <TopMargin>1in</TopMargin>
    <BottomMargin>1in</BottomMargin>
    <Style />
  </Page>
  <Description>R05-SR Week Totals</Description>
  <Author>SSRS Conversion</Author>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="PKI">
      <DataSourceReference>PKI</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>3d6cbf21-5069-48b6-b082-3b26fdb67fec</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="mainData">
      <Query>
        <DataSourceName>PKI</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@startDate">
            <Value>=Parameters!startDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@allOpenedPlanned">
            <Value>=Parameters!allOpenedPlanned.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@plannerNumber">
            <Value>=Parameters!plannerNumber.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@endDate">
            <Value>=Parameters!endDate.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>SELECT     IM.IM_PLANNER, IM.IM_KEY, MOS.MOS_WANTDATE, MOS.MOS_QTY, IM.IM_STOCK_SW, IM.IM_DESCR, IM.IM_ON_HAND, IM.IM_SAFETY, 
                      IM.IM_BUD_BUR, MOS.MOS_STATUS, MOS.MOS_QTY_REC, @startDate AS STARTDATE, DATEADD(ww, 1, @startDate) AS WEEK1, DATEADD(ww, 2, 
                      @startDate) AS WEEK2, DATEADD(ww, 3, @startDate) AS WEEK3, DATEADD(ww, 4, @startDate) AS WEEK4, DATEADD(ww, 5, @startDate) AS WEEK5, 
                      CASE WHEN MOS_WANTDATE &gt; @startDate AND MOS_WANTDATE &lt;= DATEADD(ww, 1, @startDate) 
                      THEN CASE WHEN @allOpenedPlanned = 'OPEN' THEN MOS.MOS_QTY - MOS.MOS_QTY_REC ELSE MOS_QTY END ELSE 0 END AS WEEK1QTY, 
                      CASE WHEN MOS_WANTDATE &gt; DATEADD(ww, 1, @startDate) AND MOS_WANTDATE &lt;= DATEADD(ww, 2, @startDate) 
                      THEN CASE WHEN @allOpenedPlanned = 'OPEN' THEN MOS.MOS_QTY - MOS.MOS_QTY_REC ELSE MOS_QTY END ELSE 0 END AS WEEK2QTY, 
                      CASE WHEN MOS_WANTDATE &gt; DATEADD(ww, 2, @startDate) AND MOS_WANTDATE &lt;= DATEADD(ww, 3, @startDate) 
                      THEN CASE WHEN @allOpenedPlanned = 'OPEN' THEN MOS.MOS_QTY - MOS.MOS_QTY_REC ELSE MOS_QTY END ELSE 0 END AS WEEK3QTY, 
                      CASE WHEN MOS_WANTDATE &gt; DATEADD(ww, 3, @startDate) AND MOS_WANTDATE &lt;= DATEADD(ww, 4, @startDate) 
                      THEN CASE WHEN @allOpenedPlanned = 'OPEN' THEN MOS.MOS_QTY - MOS.MOS_QTY_REC ELSE MOS_QTY END ELSE 0 END AS WEEK4QTY, 
                      CASE WHEN MOS_WANTDATE &gt; DATEADD(ww, 4, @startDate) AND MOS_WANTDATE &lt;= DATEADD(ww, 5, @startDate) 
                      THEN CASE WHEN @allOpenedPlanned = 'OPEN' THEN MOS.MOS_QTY - MOS.MOS_QTY_REC ELSE MOS_QTY END ELSE 0 END AS WEEK5QTY, 
                      CASE WHEN MOS_WANTDATE &gt; DATEADD(ww, 5, @startDate) AND MOS_WANTDATE &lt;= DATEADD(ww, 6, @startDate) 
                      THEN CASE WHEN @allOpenedPlanned = 'OPEN' THEN MOS.MOS_QTY - MOS.MOS_QTY_REC ELSE MOS_QTY END ELSE 0 END AS WEEK6QTY, 
                      CASE WHEN MOS_STATUS &lt; 3 THEN 'OPEN' ELSE 'PLANNED' END AS STATUS, 
                      CASE WHEN @allOpenedPlanned = 'OPEN' THEN MOS.MOS_QTY - MOS.MOS_QTY_REC ELSE MOS_QTY END AS QTY, 'ALL' AS [ALL]
FROM         IM LEFT OUTER JOIN
                      MOS ON IM.IM_KEY = MOS.MOS_IMKEY
WHERE     (IM.IM_PLANNER = @plannerNumber) AND (MOS.MOS_WANTDATE &gt;= @startDate) AND (MOS.MOS_WANTDATE &lt;= @endDate)
ORDER BY IM.IM_PLANNER, IM.IM_KEY, MOS.MOS_WANTDATE</CommandText>
      </Query>
      <Fields>
        <Field Name="IM_PLANNER">
          <DataField>IM_PLANNER</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="IM_KEY">
          <DataField>IM_KEY</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="MOS_WANTDATE">
          <DataField>MOS_WANTDATE</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="MOS_QTY">
          <DataField>MOS_QTY</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="IM_STOCK_SW">
          <DataField>IM_STOCK_SW</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="IM_DESCR">
          <DataField>IM_DESCR</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="IM_ON_HAND">
          <DataField>IM_ON_HAND</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="IM_SAFETY">
          <DataField>IM_SAFETY</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="IM_BUD_BUR">
          <DataField>IM_BUD_BUR</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="MOS_STATUS">
          <DataField>MOS_STATUS</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="MOS_QTY_REC">
          <DataField>MOS_QTY_REC</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="STARTDATE">
          <DataField>STARTDATE</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="WEEK1">
          <DataField>WEEK1</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="WEEK2">
          <DataField>WEEK2</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="WEEK3">
          <DataField>WEEK3</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="WEEK4">
          <DataField>WEEK4</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="WEEK5">
          <DataField>WEEK5</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="WEEK1QTY">
          <DataField>WEEK1QTY</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="WEEK2QTY">
          <DataField>WEEK2QTY</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="WEEK3QTY">
          <DataField>WEEK3QTY</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="WEEK4QTY">
          <DataField>WEEK4QTY</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="WEEK5QTY">
          <DataField>WEEK5QTY</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="WEEK6QTY">
          <DataField>WEEK6QTY</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="STATUS">
          <DataField>STATUS</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="QTY">
          <DataField>QTY</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ALL">
          <DataField>ALL</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="startDate">
      <DataType>DateTime</DataType>
      <AllowBlank>true</AllowBlank>
      <Prompt>startDate</Prompt>
    </ReportParameter>
    <ReportParameter Name="endDate">
      <DataType>DateTime</DataType>
      <Prompt>endDate</Prompt>
    </ReportParameter>
    <ReportParameter Name="plannerNumber">
      <DataType>String</DataType>
      <Prompt>plannerNumber</Prompt>
    </ReportParameter>
    <ReportParameter Name="allOpenedPlanned">
      <DataType>String</DataType>
      <Prompt>allOpenedPlanned</Prompt>
    </ReportParameter>
  </ReportParameters>
  <Code>Private keyName As String
Private currentStatus As Boolean
Function SetKey(ByVal keyValue As String) As Boolean
    If(keyName = keyValue) Then
        currentStatus=True
        Return True
    Else
        keyName=keyValue
        currentStatus=False
        Return False
    End If
End Function

Function GetStatus() As Boolean
	return currentStatus
End Function

Private keyName2 As String
Private currentStatus2 As Boolean
Function SetKey2(ByVal keyValue As String) As Boolean
    If(keyName2 = keyValue) Then
        currentStatus2=True
        Return True
    Else
        keyName2=keyValue
        currentStatus2=False
        Return False
    End If
End Function

Function GetStatus2() As Boolean
	return currentStatus2
End Function</Code>
  <Language>en-US</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>2989ba6d-12da-4675-afe3-d024791bc38b</rd:ReportID>
</Report>